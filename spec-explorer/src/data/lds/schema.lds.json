{
  "$schema": "https://lds.spec-explorer.io/v1/schema",
  "version": "1.0.0",
  "collections": {
    "tenants": {
      "primaryKey": "id",
      "fields": {
        "id": {"type": "uuid", "required": true},
        "name": {"type": "string", "required": true, "maxLength": 100},
        "slug": {"type": "string", "required": true, "unique": true},
        "plan": {"type": "enum", "values": ["free", "pro", "enterprise"]},
        "settings": {"type": "json"},
        "created_at": {"type": "timestamp"},
        "updated_at": {"type": "timestamp"}
      },
      "indexes": ["slug", "created_at"],
      "sync": {"strategy": "server-wins", "conflict": "merge"}
    },
    "users": {
      "primaryKey": "id",
      "foreignKeys": {"tenant_id": "tenants.id"},
      "fields": {
        "id": {"type": "uuid", "required": true},
        "tenant_id": {"type": "uuid", "required": true},
        "email": {"type": "string", "required": true, "format": "email"},
        "name": {"type": "string", "maxLength": 100},
        "role": {"type": "enum", "values": ["owner", "admin", "editor", "viewer"]},
        "permissions": {"type": "json"},
        "mfa_enabled": {"type": "boolean", "default": false},
        "last_login": {"type": "timestamp"},
        "created_at": {"type": "timestamp"}
      },
      "indexes": ["email", "tenant_id"],
      "sync": {"strategy": "server-wins"}
    },
    "taxonomy_sources": {
      "primaryKey": "id",
      "foreignKeys": {"tenant_id": "tenants.id"},
      "fields": {
        "id": {"type": "uuid", "required": true},
        "tenant_id": {"type": "uuid", "required": true},
        "name": {"type": "string", "required": true},
        "manufacturer": {"type": "string"},
        "version": {"type": "string"},
        "product_category": {"type": "enum", "values": ["fire_protection", "insulation", "structural", "cladding", "roofing", "flooring", "glazing", "doors_windows", "hvac", "plumbing", "electrical", "finishes", "other"]},
        "meta": {"type": "json"},
        "created_at": {"type": "timestamp"},
        "updated_at": {"type": "timestamp"}
      },
      "indexes": ["tenant_id", "manufacturer", "product_category"],
      "sync": {"strategy": "client-wins"}
    },
    "dna_sequences": {
      "primaryKey": "id",
      "foreignKeys": {"source_id": "taxonomy_sources.id", "tenant_id": "tenants.id"},
      "fields": {
        "id": {"type": "string", "required": true, "maxLength": 150},
        "tenant_id": {"type": "uuid", "required": true},
        "source_id": {"type": "uuid", "required": true},
        "rating": {"type": "string"},
        "crit_temp_c": {"type": "integer", "min": 0, "max": 1200},
        "thickness_mm": {"type": "integer", "min": 0, "max": 500},
        "max_section_factor": {"type": "integer", "min": 0, "max": 1000},
        "exposure": {"type": "enum", "values": ["3S", "4S"]},
        "fixing": {"type": "string"},
        "data": {"type": "json"},
        "searchable_text": {"type": "string", "indexed": true},
        "created_at": {"type": "timestamp"}
      },
      "indexes": ["rating", "crit_temp_c", "thickness_mm", "max_section_factor", "source_id"],
      "sync": {"strategy": "client-wins", "batch_size": 100}
    },
    "projects": {
      "primaryKey": "id",
      "foreignKeys": {"tenant_id": "tenants.id", "created_by": "users.id"},
      "fields": {
        "id": {"type": "uuid", "required": true},
        "tenant_id": {"type": "uuid", "required": true},
        "name": {"type": "string", "required": true},
        "description": {"type": "string"},
        "status": {"type": "enum", "values": ["draft", "active", "archived"]},
        "specifications": {"type": "json"},
        "created_by": {"type": "uuid"},
        "created_at": {"type": "timestamp"},
        "updated_at": {"type": "timestamp"}
      },
      "indexes": ["tenant_id", "status", "created_at"],
      "sync": {"strategy": "last-write-wins"}
    },
    "project_items": {
      "primaryKey": "id",
      "foreignKeys": {"project_id": "projects.id", "dna_sequence_id": "dna_sequences.id"},
      "fields": {
        "id": {"type": "uuid", "required": true},
        "project_id": {"type": "uuid", "required": true},
        "dna_sequence_id": {"type": "string", "required": true},
        "quantity": {"type": "integer", "default": 1},
        "notes": {"type": "string"},
        "order": {"type": "integer"},
        "created_at": {"type": "timestamp"}
      },
      "indexes": ["project_id"],
      "sync": {"strategy": "last-write-wins"}
    },
    "audit_logs": {
      "primaryKey": "id",
      "foreignKeys": {"tenant_id": "tenants.id", "user_id": "users.id"},
      "fields": {
        "id": {"type": "uuid", "required": true},
        "tenant_id": {"type": "uuid", "required": true},
        "user_id": {"type": "uuid"},
        "action": {"type": "string", "required": true},
        "entity_type": {"type": "string"},
        "entity_id": {"type": "string"},
        "changes": {"type": "json"},
        "ip_address": {"type": "string"},
        "user_agent": {"type": "string"},
        "created_at": {"type": "timestamp"}
      },
      "indexes": ["tenant_id", "created_at", "action"],
      "sync": {"strategy": "append-only"}
    }
  },
  "security": {
    "encryption": {
      "algorithm": "AES-256-GCM",
      "key_derivation": "PBKDF2",
      "iterations": 100000
    },
    "row_level_security": true,
    "tenant_isolation": "strict"
  }
}
